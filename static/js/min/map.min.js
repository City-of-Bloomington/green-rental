var RRMap=function(){var e=this;return e.zoom=14,e.lat=18.427288,e.lng=-64.446392,e.map,e.markers=[],e.showMarkers=function(){var a=e.map.getBounds(),n=a.getSouthWest(),o=a.getNorthEast();$.ajax({url:"/building/in/"+n.lat()+"/"+n.lng()+"/and/"+o.lat()+"/"+o.lng()}).done(function(a){for(var n,o,t=0,r=e.markers.length;r>t;t++)n=e.markers[t],n.setMap(null);e.markers.length=0;for(var t=0,r=a.buildings.length;r>t;t++){o=a.buildings[t],n=new google.maps.Marker({position:new google.maps.LatLng(o.lat,o.lng),map:e.map,title:o.address});var g;g=o.score>500?"/static/img/marker-green.png":o.score>250?"/static/img/marker-yellow.png":o.score>50?"/static/img/marker-orange.png":o.score>1e-4?"/static/img/marker-red.png":1e-4==o.score?"/static/img/marker-dark_gray.png":0==o.score?"/static/img/marker-light_gray.png":"/static/img/marker-light_gray.png";var i={url:g,scaledSize:new google.maps.Size(23,40),anchor:new google.maps.Point(0,12)};n.setIcon(i),e.update_info(o.profile,n),e.markers.push(n)}})},e.update_info=function(a,n){google.maps.event.addListener(n,"click",function(){e.infowindow.setContent(a),infowindow.open(map,n)})},e.initialize=function(){var a={center:new google.maps.LatLng(e.lat,e.lng),zoom:zoom,mapTypeId:google.maps.MapTypeId.ROADMAP};e.map=new google.maps.Map(document.getElementById("map-canvas"),a),e.map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(document.getElementById("legend")),e.infowindow=new google.maps.InfoWindow,google.maps.event.addListener(e.map,"idle",e.showMarkers)},e};